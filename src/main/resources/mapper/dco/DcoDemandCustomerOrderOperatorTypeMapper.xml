<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.platform.springboot.mapper.dco.DcoDemandCustomerOrderOperatorTypeMapper">
    <resultMap id="BaseResultMap" type="com.platform.springboot.entity.dco.DcoDemandCustomerOrderOperatorType">
        <id column="id" property="id" jdbcType="INTEGER"/>
        <result column="user_id" property="userId" jdbcType="INTEGER"/>
        <result column="operator_type" property="operatorType" jdbcType="VARCHAR"/>
        <result column="nick_name" property="nickName" jdbcType="VARCHAR"/>
        <result column="flag_avaliable" property="flagAvaliable" jdbcType="BIT"/>
        <result column="flag_deleted" property="flagDeleted" jdbcType="BIT"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="create_person" property="createPerson" jdbcType="INTEGER"/>
    </resultMap>
    <sql id="Base_Column_List">
    id, user_id, operator_type, nick_name, flag_avaliable, flag_deleted, create_time, 
    create_person
  </sql>
    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer">
        select
        <include refid="Base_Column_List"/>
        from dco_demand_customer_order_operator_type
        where id = #{id,jdbcType=INTEGER}
    </select>
    <insert id="insertSelective" parameterType="com.platform.springboot.entity.dco.DcoDemandCustomerOrderOperatorType">
        insert into dco_demand_customer_order_operator_type
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                id,
            </if>
            <if test="userId != null">
                user_id,
            </if>
            <if test="operatorType != null">
                operator_type,
            </if>
            <if test="nickName != null">
                nick_name,
            </if>
            <if test="flagAvaliable != null">
                flag_avaliable,
            </if>
            <if test="flagDeleted != null">
                flag_deleted,
            </if>
            <if test="createTime != null">
                create_time,
            </if>
            <if test="createPerson != null">
                create_person,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=INTEGER},
            </if>
            <if test="userId != null">
                #{userId,jdbcType=INTEGER},
            </if>
            <if test="operatorType != null">
                #{operatorType,jdbcType=VARCHAR},
            </if>
            <if test="nickName != null">
                #{nickName,jdbcType=VARCHAR},
            </if>
            <if test="flagAvaliable != null">
                #{flagAvaliable,jdbcType=BIT},
            </if>
            <if test="flagDeleted != null">
                #{flagDeleted,jdbcType=BIT},
            </if>
            <if test="createTime != null">
                #{createTime,jdbcType=TIMESTAMP},
            </if>
            <if test="createPerson != null">
                #{createPerson,jdbcType=INTEGER},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.platform.springboot.entity.dco.DcoDemandCustomerOrderOperatorType">
        update dco_demand_customer_order_operator_type
        <set>
            <if test="userId != null">
                user_id = #{userId,jdbcType=INTEGER},
            </if>
            <if test="operatorType != null">
                operator_type = #{operatorType,jdbcType=VARCHAR},
            </if>
            <if test="nickName != null">
                nick_name = #{nickName,jdbcType=VARCHAR},
            </if>
            <if test="flagAvaliable != null">
                flag_avaliable = #{flagAvaliable,jdbcType=BIT},
            </if>
            <if test="flagDeleted != null">
                flag_deleted = #{flagDeleted,jdbcType=BIT},
            </if>
            <if test="createTime != null">
                create_time = #{createTime,jdbcType=TIMESTAMP},
            </if>
            <if test="createPerson != null">
                create_person = #{createPerson,jdbcType=INTEGER},
            </if>
        </set>
        where id = #{id,jdbcType=INTEGER}
    </update>
    <select id="getOptTypeByUserId" resultMap="BaseResultMap" parameterType="java.lang.Integer">
        select
        <include refid="Base_Column_List"/>
        from dco_demand_customer_order_operator_type
        where user_id = #{userId,jdbcType=INTEGER}
    </select>
    <select id="getTechnologyListByUserId" resultMap="BaseResultMap" parameterType="java.util.List">
        select
        <include refid="Base_Column_List"/>
        from dco_demand_customer_order_operator_type
        where operator_type = 'TECHNICIST'
        AND flag_deleted = 0
        AND user_id IN
        <foreach item="item" collection="list" separator="," open="(" close=")" index="">
            #{item.id, jdbcType=INTEGER}
        </foreach>
    </select>
    <select id="getCustomerServiceListByUserId" resultMap="BaseResultMap" parameterType="java.util.List">
        select
        <include refid="Base_Column_List"/>
        from dco_demand_customer_order_operator_type
        where operator_type = 'SERVICE'
        AND flag_deleted = 0
        AND user_id IN
        <foreach item="item" collection="list" separator="," open="(" close=")" index="">
            #{item.id, jdbcType=INTEGER}
        </foreach>
    </select>

    <select id="queryServiceListByActType" resultMap="BaseResultMap" parameterType="com.platform.springboot.entity.sys.SysCompanyUsers">
    select
    operatorType.user_id as userId,
    operatorType.nick_name as nickName
    from dco_demand_customer_order_operator_type operatorType
    INNER JOIN sys_company_users users on users.id = operatorType.user_id and users.flag_deleted = 0
    and users.act_type = #{actType,jdbcType=VARCHAR} and users.act_Object_id = #{actObjectId,jdbcType=INTEGER}
    where operatorType.flag_deleted = 0
  </select>

</mapper>